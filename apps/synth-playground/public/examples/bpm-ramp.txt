import { OscillatorSynthNode, ADSREnvelopeSynthNode, Time, Seconds, Hertz, Notes, Normal, Pitch } from 'synth'
import { synth } from 'synth/playground'

const oscillator = new OscillatorSynthNode(synth)
const envelope = new ADSREnvelopeSynthNode(synth)

oscillator.connect(envelope)
envelope.connect(synth.output)

oscillator.frequency.initialValue = Pitch.a4.hertz
oscillator.waveShape.value = 'sawtooth'
envelope.attack.initialValue = Time.n1.notes
envelope.decay.initialValue = Time.n1.notes
envelope.sustain.initialValue = Normal(0.5)
envelope.release.initialValue = Time.n1.notes

let time = Time.start
for (let i = 0; i < 5; i++) {
  envelope.attackAt(time)
  time = time.add(Time.n1)
  envelope.releaseAt(time)
  time = time.add(Time.n1)
  oscillator.frequency.curve.rampValueUntil(time, Hertz(440 + 40 * i))
  synth.secondsPerNote.rampValueUntil(time, Seconds(1 / (i + 1)))
}
